-- LEFT JOIN 사용하여 맛을 연결하고 배의 번호가 다르더라도 튜플이 나올 수 있도록 LEFT JOIN을 사용할 수 있다.
SELECT FLAVOR
FROM
(SELECT A.FLAVOR, (SUM(A.TOTAL_ORDER)+SUM(B.TOTAL_ORDER)) AS TOTAL_ORDER
FROM JULY A LEFT JOIN FIRST_HALF B 
ON A.FLAVOR=B.FLAVOR 
AND A.SHIPMENT_ID = B.SHIPMENT_ID
GROUP BY A.FLAVOR
ORDER BY TOTAL_ORDER DESC
LIMIT 3) FT

-- B의 기본키가 FLAVOR이기 때문에 총 주문량은 하나이다. 일반 조인의 조건으로 맛을 선택할 B의 경우 TOTAL ORDER가 여러개 생성될 수 있다.
-- 따라서 이 경우에 하나만 선택해서 더해줘야 하기에 B.TOTAL_ORDER를 더해준다.

SELECT FLAVOR
FROM
(SELECT A.FLAVOR, (SUM(A.TOTAL_ORDER)+B.TOTAL_ORDER) AS TOTAL_ORDER
FROM JULY A JOIN FIRST_HALF B 
ON A.FLAVOR=B.FLAVOR 
GROUP BY A.FLAVOR
ORDER BY TOTAL_ORDER DESC
LIMIT 3) FT